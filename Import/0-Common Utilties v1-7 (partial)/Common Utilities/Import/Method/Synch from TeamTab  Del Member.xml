<AML>
 <Item type="Method" id="3EC8ED0DA06941E180C2265731C2FB4B" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA['MethodTemplateName=VBMain;
' called onAfterDelete of "team Relationhip"  (i.e. Program Team)
Dim inn As Innovator = Me.getInnovator()
  
Function Main() As Item
  'System.Diagnostics.Debugger.Break()

  Dim thisTeamRel As Item = Me.newItem(Me.GetType(),"get")
  thisTeamRel.setID(Me.getID())
  thisTeamRel.setAttribute("select","source_id(team_id,config_id,name),related_id(keyed_name)")
  thisTeamRel.setAttribute("serverEvents","0")
  thisTeamRel = thisTeamRel.apply()

  If thisTeamRel.isError() Then Return thisTeamRel

  Dim teamSystemId As String = thisTeamRel.getPropertyItem("source_id").getProperty("team_id","")
  If teamSystemId = "" Then
    Return Me ' nothing to do
  End If

  ' delete relationship from Team Item 
  Dim SQLstr As String = "DELETE FROM [Team_Identity]"
  SQLstr = SQLstr & " WHERE [Team_Identity].source_id='" & teamSystemId  & "'"
  SQLstr = SQLstr & " AND  [Team_Identity].related_id='" & thisTeamRel.getProperty("related_id","") & "'"
  Dim amlCmd As Item = inn.applySQL(SQLstr)
  If amlCmd.isError() Then Return amlCmd

  Return Me

End Function
]]></method_code>
  <method_type>VB</method_type>
  <name>Synch from TeamTab  Del Member</name>
 </Item>
</AML>