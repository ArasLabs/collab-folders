<AML>
 <Item type="Method" id="DED68DD389B24E198757710DCB5D6EC8" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA['MethodTemplateName=VBMain;
' called: onAferDelete
'   requires method: 'Add Props to Folder BeforeDelete' to be run onBeforeDelete
Dim inn As Innovator = Me.getInnovator()
  
Function Main() As Item
  'System.Diagnostics.Debugger.Break()
 
  Dim thisPS As Item = Me

  Dim ItemConfigId As String = thisPS.getProperty("config_id","")
  Dim ItemId As String = thisPS.GetID()

  ' delete the related PS Team Item
  Dim amlCmd As Item = inn.newItem("Team","delete")
  
  Dim whereStr As String = "[Team].description like '%" & ItemConfigId  & "%'"
  whereStr = whereStr  & " or [Team].description like '%" & ItemId  & "%'"
  amlCmd.setAttribute("where",whereStr)

  ' run under different identity  
  Dim plmIdentity As Aras.Server.Security.Identity  = Aras.Server.Security.Identity.GetByName("Super User")
  Dim PermissionWasSet As Boolean  = Aras.Server.Security.Permissions.GrantIdentity(plmIdentity)

  amlCmd = amlCmd.apply()
  
  ' Revoke 'Aras PLM' permissions
  If (PermissionWasSet) Then Aras.Server.Security.Permissions.RevokeIdentity(plmIdentity)
  
  If amlCmd.isError() Then Return amlCmd

  Return Me

End Function

]]></method_code>
  <method_type>VB</method_type>
  <name>Delete Folder related Team</name>
 </Item>
</AML>