<AML>
 <Item type="Method" id="BD0A5BDE4C24467FA73C5974E4477751" action="add">
  <comments>automatically adds a top folder to Folder Template</comments>
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA['System.Diagnostics.Debugger.Break()
' called onBeforeAdd of "Item Folder Template"
If Me.getProperty("name","") <> "" And Me.getProperty("top_item_folder_id","") = "" Then

  Dim newFolder As Item = Me.newItem("Item Folder","add")
  newFolder.setProperty("name",Me.getProperty("name",""))
  newFolder.setProperty("permission_id","E2227109B19B45E0B4690EEE5E890FBB") ' permission: Item Folder Template
  
  newFolder.setProperty("is_template","1")
  newFolder = newFolder.apply()
  
  If newFolder.isError() Then Return newFolder
  
  Me.setProperty("top_item_folder_id",newFolder.GetID())
  
End If
Return Me
]]></method_code>
  <method_type>VB</method_type>
  <name>FolderTemplate AddNew Top Folder</name>
 </Item>
</AML>