<AML>
 <Item type="Method" id="8773E9E4F2D14EED80E9C60A1F467BBD" action="add">
  <comments>Use with onPopulate on form of ItemTypes that have relationship with gridView with the Folder Structure</comments>
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[// This method refreshes grid on user click "Refresh" button.
// Solutions install this method to onPopulateEvent of Forms:
//          Item Folder, Project, Program

for (var tabId in top.document.frames[2].iframesCollection) {
	var relshipTypeNd = top.aras.getRelationshipType(tabId);
	var relshipTypeName = top.aras.getItemProperty(relshipTypeNd.node, "name");
	if(relshipTypeName.indexOf("Folder") > 0 && relshipTypeName.indexOf("Structure")) {
		var formFrame = top.document.frames[2].iframesCollection[tabId].contentWindow.frames['formFrame'];
		if(formFrame && formFrame.window.window.RefreshGrid) {
			formFrame.window.window.RefreshGrid(true);
		}
	}
}
]]></method_code>
  <method_type>JavaScript</method_type>
  <name>ItemFolderStructForceGridRefresh</name>
 </Item>
</AML>