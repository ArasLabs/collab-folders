<AML>
 <Item type="Method" id="A337F25D9B664F6384586E185974E02C" action="add">
  <execution_allowed_to keyed_name="World" type="Identity">A73B655731924CD0B027E4F4D5FCC0A9</execution_allowed_to>
  <method_code><![CDATA[' on After Add of "cFolder Controlled Item" and "cFolder File"
'
'set templ flag on relationship, if source item also has templ flag set
'System.Diagnostics.Debugger.Break()
Dim inn As Innovator = Me.getInnovator()

Dim thisFolderRel As Item = inn.newItem(Me.GetType(),"get")
thisFolderRel.setID(Me.getID())
thisFolderRel.setAttribute("select","source_id(is_template)")
thisFolderRel = thisFolderRel.apply()
Dim typeTable As String = ""
Dim SQLstr As String = ""
Dim res As Item

Dim isTemplateFlag As String = ""
Dim folderPermission As String = ""
If Not thisFolderRel.isError() Then
  isTemplateFlag = thisFolderRel.getPropertyItem("source_id").getProperty("is_template","0")

  If isTemplateFlag = "1" Then
    typeTable = thisFolderRel.GetType().Replace(" ","_")
    SQLstr = "UPDATE [" & typeTable & "]"
    SQLstr = SQLstr & " SET [" & typeTable & "].is_template='1'"
    SQLstr = SQLstr & " WHERE [" & typeTable & "].id='" & thisFolderRel.getID() & "'"
    res = inn.applySQL(SQLstr)
  End If
End If
Return Me]]></method_code>
  <method_type>VB</method_type>
  <name>Set Templ Flag on Folder Rel</name>
 </Item>
</AML>